%{
    chapter 3 : time domain

    1  :  tf2ss()
    2  : ss for given tf
    3  : tf for given ss
    4  : skill ass3.4   with alternative--> quick way
    5  : ch3.10a + 2.11, tf2ss
    6  : ch3.10b + 2.11, tf2ss
    7  : ch3.13a given ss, find tf
    8  : ch3.21
    9  : ch3.20
    10 : quiz, ch3

    ss(), tf2ss(), ss2tf(), inv() \, eye()
%}
close all;
clc;
select = 10;


%------------------------------------------------------------------------------------------
if (select == 1)
    H_num = [1, 7, 2];
    H_den = [1, 9, 26, 24];
    [A, B, C, D] = tf2ss(H_num, H_den);
    P = [0, 0, 1; 0, 1, 0; 1, 0, 0];
    A = P \ A * P
    B = P \ B;
    C = C * P;
end

%------------------------------------------------------------------------------------------
if (select == 2)
    H_num = [2, 1];
    H_den = [1, 7, 9];
    [A, B, C, D] = tf2ss(H_num, H_den)
end

%------------------------------------------------------------------------------------------
if (select == 3)
    syms s;
    A = [0 1, 0; 0, 0, 1; -1, -2, -3];
    B = [10; 0; 0];
    C = [1, 0, 0];
    D = 0;
    Y = inv(s .* eye(3) - A);
    Hs = C * Y * B + D;
    pretty(Hs);
end

%------------------------------------------------------------------------------------------
if (select == 4)
    syms s;
    A = [-4, -1.5; 4, 0];
    B = [2; 0];
    C = [1.5, 0.625];
    D = 0;
    Y = inv(s .* eye(2) - A);
    Hs = C * Y * B + D;
    pretty(Hs);
    % try this for speed:
    T = ss(A, B, C, D);
    T = tf(T);
end

%------------------------------------------------------------------------------------------
if (select == 5)
    H_num = [3, 9];
    H_den = [1, 8, 1, 7, 10];
    [A, B, C, D] = tf2ss(H_num, H_den)
end

%------------------------------------------------------------------------------------------
if (select == 6)
    H_num = [1, 3, 15, 5, 7];
    H_den = [1, 8, 12, 17, 0, 0];
    [A, B, C, D] = tf2ss(H_num, H_den)
end

%------------------------------------------------------------------------------------------
if (select == 7)
    syms s;
    A = [0, 1, 0; 0, 0, 1; -1, -3, -2];
    B = [0; 0; 23];
    C = [1, 0, 0];
    D = 0;
    Y = inv(s .* eye(3) - A);
    Hs = C * Y * B + D;
    pretty(Hs);
    % try this for speed:
    T = ss(A, B, C, D);
    T = tf(T)
end

%------------------------------------------------------------------------------------------
if (select == 8)
    syms s;
    A_a = -10;
    B_a = 4;
    C_a = 9;
    D_a = 0;
    T_a = ss(A_a, B_a, C_a, D_a);
    T_a = tf(T_a)
    
    A_b = [-10, 0; 0, -1];
    B_b = [4; 1];
    C_b = [9, 0];
    D_b = 0;
    T_b = ss(A_b, B_b, C_b, D_b);
    T_b = tf(T_b)
    
    A_c = [-10, 1; 0, -1];
    B_c = [4; 0];
    C_c = [9, 4];
    D_c = 0;
    T_c = ss(A_c, B_c, C_c, D_c);
    T_c = tf(T_c)
end

%------------------------------------------------------------------------------------------
if (select == 9)
    syms s;
    A = [-0.038, 0.896, 0, 0.0015;
         0.0017, -0.092, 0, -0.0056;
         1, 0, 0, -3.086;
         0, 1, 0, 0];
    B = [-0.0075, -0.023;
         0.0017, -0.0022;
         0, 0;
         0, 0];
    C = [0, 0, 1, 0;
         0, 0, 0, 1];
    D = 0;
    Y = inv(s .* eye(4) - A);
    Hs = C * Y * B + D;
    pretty(Hs);
    % try this for speed:
    T = ss(A, B, C, D);
    T = tf(T);
end

%------------------------------------------------------------------------------------------
if (select == 10)
    [A, B, C, D] = tf2ss([5, -9, 10], [1, 8, 0, -4])
end